<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰ç«¯çŠ¶æ€æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-item { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .loading { background-color: #fff3cd; border-color: #ffeaa7; }
    </style>
</head>
<body>
    <h1>AIæ‹‰ç‰‡åŠ©æ‰‹ - å‰ç«¯çŠ¶æ€æµ‹è¯•</h1>
    
    <div id="frontend-test" class="test-item loading">
        <h3>ğŸŒ å‰ç«¯æœåŠ¡æµ‹è¯•</h3>
        <p id="frontend-status">æµ‹è¯•ä¸­...</p>
    </div>
    
    <div id="backend-test" class="test-item loading">
        <h3>ğŸ”§ åç«¯APIæµ‹è¯•</h3>
        <p id="backend-status">æµ‹è¯•ä¸­...</p>
    </div>
    
    <div id="css-test" class="test-item loading">
        <h3>ğŸ¨ CSSæ ·å¼æµ‹è¯•</h3>
        <p id="css-status">æµ‹è¯•ä¸­...</p>
    </div>
    
    <div id="registration-test" class="test-item loading">
        <h3>ğŸ“ æ³¨å†ŒåŠŸèƒ½æµ‹è¯•</h3>
        <p id="registration-status">å‡†å¤‡ä¸­...</p>
        <button id="test-registration" onclick="testRegistration()">æµ‹è¯•æ³¨å†Œ</button>
    </div>
    
    <div id="login-test" class="test-item loading">
        <h3>ğŸ” ç™»å½•åŠŸèƒ½æµ‹è¯•</h3>
        <p id="login-status">å‡†å¤‡ä¸­...</p>
        <button id="test-login" onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
    </div>

    <script>
        // æµ‹è¯•å‰ç«¯æœåŠ¡
        async function testFrontend() {
            try {
                const response = await fetch('http://localhost:3000');
                if (response.ok) {
                    document.getElementById('frontend-status').textContent = 'âœ… å‰ç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ (localhost:3000)';
                    document.getElementById('frontend-test').className = 'test-item success';
                } else {
                    document.getElementById('frontend-status').textContent = 'âŒ å‰ç«¯æœåŠ¡å“åº”å¼‚å¸¸';
                    document.getElementById('frontend-test').className = 'test-item error';
                }
            } catch (error) {
                document.getElementById('frontend-status').textContent = 'âŒ å‰ç«¯æœåŠ¡è¿æ¥å¤±è´¥: ' + error.message;
                document.getElementById('frontend-test').className = 'test-item error';
            }
        }

        // æµ‹è¯•åç«¯API
        async function testBackend() {
            try {
                const response = await fetch('http://localhost:8000/health');
                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('backend-status').textContent = 
                        `âœ… åç«¯APIæ­£å¸¸è¿è¡Œ - ç‰ˆæœ¬: ${data.version}, æ•°æ®åº“: ${data.database}, ç”¨æˆ·æ•°: ${data.user_count}`;
                    document.getElementById('backend-test').className = 'test-item success';
                } else {
                    document.getElementById('backend-status').textContent = 'âŒ åç«¯APIå“åº”å¼‚å¸¸';
                    document.getElementById('backend-test').className = 'test-item error';
                }
            } catch (error) {
                document.getElementById('backend-status').textContent = 'âŒ åç«¯APIè¿æ¥å¤±è´¥: ' + error.message;
                document.getElementById('backend-test').className = 'test-item error';
            }
        }

        // æµ‹è¯•CSSæ ·å¼
        function testCSS() {
            const testElement = document.createElement('div');
            testElement.style.cssText = 'position: absolute; top: -9999px; left: -9999px;';
            testElement.className = 'test-tailwind bg-blue-500 text-white p-4';
            document.body.appendChild(testElement);
            
            const computedStyle = window.getComputedStyle(testElement);
            const hasBackground = computedStyle.backgroundColor !== 'rgba(0, 0, 0, 0)' && computedStyle.backgroundColor !== 'transparent';
            
            document.body.removeChild(testElement);
            
            if (hasBackground) {
                document.getElementById('css-status').textContent = 'âœ… CSSæ ·å¼æ­£å¸¸åŠ è½½ (Tailwind CSSå·¥ä½œæ­£å¸¸)';
                document.getElementById('css-test').className = 'test-item success';
            } else {
                document.getElementById('css-status').textContent = 'âš ï¸ CSSæ ·å¼å¯èƒ½æœªæ­£ç¡®åŠ è½½';
                document.getElementById('css-test').className = 'test-item error';
            }
        }

        // æµ‹è¯•æ³¨å†ŒåŠŸèƒ½
        async function testRegistration() {
            const testEmail = `test_${Date.now()}@example.com`;
            const testData = {
                email: testEmail,
                password: 'test123456',
                name: 'æµ‹è¯•ç”¨æˆ·'
            };

            try {
                const response = await fetch('http://localhost:8000/api/v1/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData),
                });

                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('registration-status').textContent = 
                        `âœ… æ³¨å†ŒåŠŸèƒ½æ­£å¸¸ - ç”¨æˆ·ID: ${data.id.substring(0, 8)}...`;
                    document.getElementById('registration-test').className = 'test-item success';
                } else {
                    const errorData = await response.json();
                    document.getElementById('registration-status').textContent = 
                        `âŒ æ³¨å†Œå¤±è´¥: ${errorData.detail}`;
                    document.getElementById('registration-test').className = 'test-item error';
                }
            } catch (error) {
                document.getElementById('registration-status').textContent = 'âŒ æ³¨å†Œæµ‹è¯•å¤±è´¥: ' + error.message;
                document.getElementById('registration-test').className = 'test-item error';
            }
        }

        // æµ‹è¯•ç™»å½•åŠŸèƒ½
        async function testLogin() {
            const testData = {
                email: 'admin@example.com',
                password: 'admin123456'
            };

            try {
                const response = await fetch('http://localhost:8000/api/v1/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData),
                });

                if (response.ok) {
                    const data = await response.json();
                    document.getElementById('login-status').textContent = 
                        `âœ… ç™»å½•åŠŸèƒ½æ­£å¸¸ - Tokenç±»å‹: ${data.token_type}`;
                    document.getElementById('login-test').className = 'test-item success';
                } else {
                    const errorData = await response.json();
                    document.getElementById('login-status').textContent = 
                        `âŒ ç™»å½•å¤±è´¥: ${errorData.detail}`;
                    document.getElementById('login-test').className = 'test-item error';
                }
            } catch (error) {
                document.getElementById('login-status').textContent = 'âŒ ç™»å½•æµ‹è¯•å¤±è´¥: ' + error.message;
                document.getElementById('login-test').className = 'test-item error';
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('load', function() {
            testFrontend();
            testBackend();
            setTimeout(testCSS, 100); // ç¨å¾®å»¶è¿Ÿç¡®ä¿æ ·å¼åŠ è½½å®Œæˆ
        });
    </script>
</body>
</html> 